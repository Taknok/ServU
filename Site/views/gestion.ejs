<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="google-site-verification" content="JS4lLxllrxJ--QxMseg7otfgj_J38auIdWuUiySrrkA" />

    <title>ServU</title>

    <link rel="icon" type="image/png" href="../img/smallLogo.png" />
    <!-- Bootstrap Core CSS -->
    <link href="../css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../css/stylish-portfolio.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="../css/ionicons.css" rel="stylesheet" type="text/css">

    <!-- Personnal CSS Piti -->
    <link href="../css/persoCSS/amethystFont.css" rel="stylesheet">
    <link href="../css/persoCSS/colorOrange.css" rel="stylesheet">

    <link href="../css/persoCSS/custom.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.5.4/bootstrap-select.min.css" rel="stylesheet">

    <!-- qrcode library -->
    <script type="text/javascript" src="../js/qrcode.js"></script>



</head>

<body ng-app="root" ng-controller="gestion">

<!-- Navigation 2-->
<a id="menu-toggle" href="#" class="btn btn-dark btn-lg toggle"><i class="fa fa-bars"></i></a>
<nav id="sidebar-wrapper">
    <ul class="sidebar-nav">
        <a id="menu-close" href="#" class="btn btn-light btn-lg pull-right toggle"><i class="fa fa-times"></i></a>
        <li class="sidebar-brand">
            <a href="/" onclick=$("#menu-close").click();>ServU</a>
        </li>
        <li>
            <a href="/" onclick=$("#menu-close").click();>Home</a>
        </li>
        <li>
            <a href="/logout" onclick=$("#menu-close").click();>Logout</a>
        </li>
        <li>
            <hr>
        </li>
        <li>
            <a href="#profile" onclick=$("#menu-close").click();>Profil</a>
        </li>
        <li>
            <a href="#devices" onclick=$("#menu-close").click();>Devices</a>
        </li>
        <li>
            <a href="#event" onclick=$("#menu-close").click();>Event Creator</a>
        </li>
    </ul>
</nav>

<!-- Profile -->
<section id="profile" class="profile">
    <div class="container">


        <div class="row">
            <% if(typeof error != 'undefined'){ %>
            <div class="alert alert-danger fade in center-block" style="width : 50%;">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <strong>Error : </strong><%= error %>
            </div>
            <% } %>
            <% if(typeof success != 'undefined'){ %>
            <div class="alert alert-success fade in center-block" style="width : 50%;">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <strong>Success : </strong><%= success %>
            </div>
            <% } %>
            <div class="col-md-12 col-xs-12 text-center">
                <h2 class="fontAmethyst"><%= username %></h2>
                <hr class="small">
            </div>
        </div>
        <div class="row gutter-10">
            <div class="col-md-10 col-xs-10 col-md-offset-1 col-xs-offset-1 gutter-10">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <div class="row">
                                <div class="col-lg-11 col-md-11 col-sm-11 col-xs-10">
                                    <h4 class="fontAmethyst"><i class="fa fa-user hidden-xs clearfix"></i> User Info</h4>
                                </div>
                                <div class="col-lg-1 col-md-1 col-sm-1 col-xs-2 text-vertical-center">
                                    <a type="button" class="btn btn-warning pull-right" data-toggle="collapse" data-target="#infoProfile"><i class="fa fa-info"></i></a>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    </div>

                    <div class="panel-body collapse" id="infoProfile">
                        <div class="row">
                            <div class="col-md-4 col-sm-10 col-xs-10">
                                <p class="lead">
                                    Pseudo : <%= username %><br>
                                    First name : <%= firstname %><br>
                                    Last name : <%= lastname %><br>
                                    Email : <%= email %><br>
                                </p>
                            </div>
                            <div class="col-md-8 col-sm-12 col-xs-12">
                                <div class="row">
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <button type="button" class="btn btn-primary center-block" data-toggle="collapse" data-target="#modifyNames"><i class="glyphicon glyphicon-pencil"></i> Modify your names</button>
                                        <br>
                                    </div>
                                    <div class="row collapse" id="modifyNames">
                                        <form action="/users/<%= username%>?_method=PUT" method="post" class="form-horizontal" id="modif_info" data-toggle="validator">
                                            <div class="form-group">
                                                <label class="control-label col-md-4 col-sm-4 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1" for="text">Change first name :</label>
                                                <div class="col-md-6 col-sm-6 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1">
                                                    <input type="text" class="form-control" id="firstname" name="firstname" data-minlength="1" placeholder="Enter new first name" required>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-4 col-sm-4 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1" for="text">Change last name :</label>
                                                <div class="col-md-6 col-sm-6 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1">
                                                    <input type="text" class="form-control" id="lastname" name="lastname" data-minlength="1" placeholder="Enter new last name" required>
                                                </div>
                                            </div>
                                            <div class="form-group text-center">
                                                <button type="submit" class="btn btn-primary" >Confirm</button>
                                            </div>
                                        </form>
                                    </div>
                                    <hr class="reduce">
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <button type="button" class="btn btn-primary center-block" data-toggle="collapse" data-target="#modifyPassword"><i class="glyphicon glyphicon-pencil"></i> Modify password</button>
                                        <br>
                                    </div>
                                    <div class="row collapse" id="modifyPassword">
                                        <form action="/users/<%= username%>?_method=PUT" method="post" class="form-horizontal" id="modif_mdp" data-toggle="validator">
                                            <div class="form-group">
                                                <label class="control-label col-md-4 col-sm-4 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1" for="text">Current password :</label>
                                                <div class="col-md-6 col-sm-6 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1">
                                                    <input type="password" class="form-control" name="oldPassword" id="oldPassword" placeholder="Enter your current password" data-minlength="6" required>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-4 col-sm-4 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1" for="text">New password :</label>
                                                <div class="col-md-6 col-sm-6 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1">
                                                    <input type="password" class="form-control" name="password" id="password" placeholder="Enter your new password" data-minlength="6" required>
                                                    <div class="help-block">Minimum of 6 characters</div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="control-label col-md-4 col-sm-4 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1" for="pwd">Confirm password :</label>
                                                <div class="col-md-6 col-sm-6 col-xs-10 col-md-offset-0 col-sm-offset-0 col-xs-offset-1">
                                                    <input type="password" class="form-control" name="password2" id="password2" data-match="#password" data-match-error="These don't match" placeholder="Confirm password" required>
                                                    <div class="help-block with-errors"></div>
                                                </div>
                                            </div>
                                            <div class="form-group text-center">
                                                <button type="submit" class="btn btn-primary">Confirm</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div><!— /.row —>
    </div><!-- /.container -->
</section>

<!-- Devices -->
<section id="devices" class="devices bg-primary">
    <div class="container" ng-controller="devicesCtrl">
        <div class="row">
            <div class="col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-center">
                <div class="panel panel-primary" style="border: none">
                    <div class="panel-heading">
                        <div class="row">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <h2 class="fontAmethyst">Devices</h2>
                                <hr class="small">
                            </div>
                        </div>
                        <div class="row gutter-10">
                            <div class="col-md-2 col-sm-2 col-xs-2 gutter-10 pull-left">
                                <div class='well well-sm well-warning'>
                                    <i class="fa fa-mobile-phone"></i> <b>{{devices.length}}</b> devices
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-4 col-xs-4 gutter-10 pull-right">
                                <div class="btn-group" style="margin-top: 25%; margin-bottom: 25%">
                                    <button class="btn btn-warning" data-toggle="modal" data-target='#addModal'>
                                        <span data-toggle="tooltip" title="Download app" data-placement="top">
                                            <i class="glyphicon glyphicon-download-alt"></i>
                                        </span>
                                    </button>
                                    <div class="btn btn-warning" data-toggle="tooltip" data-placement="top" title="Refresh" ng-init="refreshDevices()" ng-click="refreshDevices()">
                                        <i class="glyphicon glyphicon-refresh"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="alertActionSentPlace"></div>
                    <div class="panel-body"> <!-- Devices -->
                        <div id="items">
                            <div class="row" style="margin-bottom: 1%">
                                <div class="col-md-12">
                                    <div class='btn-group dropdown'>
                                        <button type='button' class='btn btn-primary dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>
                                            <i class='fa fa-bullhorn'></i>
                                            <span class='text-center'>  Send an action to all devices  </span>
                                            <span class='caret'></span>
                                            <span class='clearfix'></span>
                                        </button>
                                        <ul class='dropdown-menu'>
                                            <li ng-repeat="action in allActionsAvailable">
                                                <a data-toggle="modal" data-target="#actionToAllModal" ng-click="changeActionToSendToAll(action)">
                                                    <div class='pull-left' style="text-transform: capitalize;">{{action.label}}</div>
                                                    <i class="ion pull-right" ng-class="{'ion-ios-bell': action.name==='ring',
                                                                     'ion-radio-waves': action.name==='vibrate',
                                                                     'ion-flash': action.name==='flashlight',
                                                                     'ion-android-chat': action.name==='sms'}"></i>
                                                    <div class="clearfix"></div>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="row" ng-repeat="device in devices">
                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                    <div class="panel panel-warning panel-warning-dark">
                                        <div class='panel-heading'>
                                            <div class='row gutter-10'>
                                                <div class='col-lg-2 col-md-2 col-sm-2 col-xs-2 gutter-10'>
                                                    <h3 class='panel-title' id='deviceLogo'><i class='fa fa-mobile-phone fa-lg'></i></h3>
                                                </div>
                                                <div class='col-lg-8 col-md-8 col-sm-8 col-xs-8 gutter-10'>
                                                    <div id='deviceTitle' class='panel-title text-center'>{{device.name}}</div>
                                                </div>
                                                <div class='col-lg-2 col-md-2 col-sm-2 col-xs-2 gutter-10'>
                                                    <span data-toggle='tooltip' title='Delete' data-placement='top'>
                                                        <button class='btn btn-danger btn-xs' data-toggle="modal" data-target="#deleteModal" ng-click="changeDeleteDevice(device.uuid)">
                                                             <i class='glyphicon glyphicon-minus'></i>
                                                        </button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='panel-body'>
                                            <div class='row'>
                                                <div class='col-md-1'><i class='fa fa-mobile-phone'></i></div>
                                                <div class='col-md-5'>{{device.manufacturer}} {{device.model}}</div>
                                                <div class='col-md-1'><i class='glyphicon glyphicon-signal'></i></div>
                                                <div class='col-md-5'>{{device.probes.network.data.state}}</div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-1"><i class="fa fa-barcode"></i></div>
                                                <div class="col-md-5">{{device.serial}}</div>
                                                <div class="col-md-1"><i class="fa fa-info-circle"></i></div>
                                                <div class="col-md-5">{{device.platform}} {{device.version}}</div>
                                            </div>
                                            <div class='row'>
                                                <div class='col-md-1' id='deviceCharge'><i class='ion' ng-class="{'ion-battery-charging': device.probes.battery.data.isPlugged, 'ion-battery-full': !device.probes.battery.data.isPlugged}"></i></div>
                                                <div class='col-md-11'>
                                                    <div class='progress'>
                                                        <div class='progress-bar'
                                                             ng-class="{'progress-bar-primary': getBarTypeClassBoolean(device.probes.battery.data.level,'primary'),
                                                             'progress-bar-success': getBarTypeClassBoolean(device.probes.battery.data.level,'success'),
                                                             'progress-bar-warning': getBarTypeClassBoolean(device.probes.battery.data.level,'warning'),
                                                             'progress-bar-danger': getBarTypeClassBoolean(device.probes.battery.data.level,'danger'),
                                                             'progress-bar-striped active': device.probes.battery.data.isPlugged }"
                                                             role='progressbar' aria-valuenow='{{device.probes.battery.data.level}}'
                                                             aria-valuemin='0' aria-valuemax='100' style='width: {{device.probes.battery.data.level}}%'>
                                                            <span><b>{{device.probes.battery.data.level}}%</b></span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class='panel-footer'>
                                            <div class='row'>
                                                <div class='btn-group-in-footer btn-group btn-group-justified'>
                                                    <div class='btn-group'>
                                                        <button class='btn btn-warning' data-toggle="modal" data-target="#moreModal" ng-click="changeMoreDevice(device.uuid)">
                                                            <i class='glyphicon glyphicon-plus-sign'></i>
                                                            <span class='text-center'>  Show more  </span>
                                                            <span class='clearfix'></span>
                                                        </button>
                                                    </div>
                                                    <div class='btn-group dropdown'>
                                                        <button type='button' class='btn btn-warning dropdown-toggle' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false'>
                                                            <i class='glyphicon glyphicon-th-large'></i>
                                                            <span class='text-center'>  Quick actions  </span>
                                                            <span class='caret'></span>
                                                            <span class='clearfix'></span>
                                                        </button>
                                                        <ul class='dropdown-menu'>
                                                            <li ng-repeat="action in device.actionsAvailable">
                                                                <a data-toggle="modal" data-target="#actionModal" ng-click="changeActionToSend(device.name,device.uuid,action)" ng-show="action.enabled">
                                                                    <div class='pull-left' style="text-transform: capitalize;">{{action.label}}</div>
                                                                    <i class="ion pull-right" ng-class="{'ion-ios-bell': action.name==='ring',
                                                                     'ion-radio-waves': action.name==='vibrate',
                                                                     'ion-flash': action.name==='flashlight',
                                                                     'ion-android-chat': action.name==='sms'}"></i>
                                                                    <div class="clearfix"></div>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12" id="angular_module">
                                    <div class="panel panel-primary">
                                        <div class="panel-heading">
                                            <div class="row">
                                                <div class="col-lg-offset-2 col-lg-8 col-md-offset-2 col-md-8 col-sm-offset-2 col-sm-8 col-xs-offset-2 col-xs-8 text-center">
                                                    <div class="panel-title">Events of {{device.name}}</div>
                                                </div>
                                                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 pull-right">
                                                    <button class='btn btn-xs btn-info' data-toggle='modal' data-target='#chooseEventModal' ng-click="changeChooseEventDevice(device.uuid)"><i class='glyphicon glyphicon-plus'></i></button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="panel-body" style="color: black">
                                            <ul class="list-group text-left" ng-repeat="event in events">
                                                <a class="list-group-item">
                                                    <h4 class="list-group-item-heading">
                                                        {{event.label}}
                                                        <div class="btn btn-danger btn-xs pull-right" data-toggle="tooltip" data-placement="top" title="Disassociate event" ng-click="disassociateEvent(device.uuid,event.id)">
                                                            <i class="glyphicon glyphicon-remove"></i>
                                                        </div>
                                                    </h4>
                                                    <p class="list-group-item-text">
                                                        {{event.description}}
                                                    </p>
                                                </a>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- ./row ./devices -->
                    </div>
                    <!-- ./panel-body -->
                </div>
                <!-- ./Main panel -->
            </div>
            <!-- /.col-lg-10 -->
        </div>
        <!-- /.row -->
        <!-- More modal -->
        <div class="text-left">
            <div class='modal fade' id='moreModal' tabindex='-1' role='dialog' aria-labelledby='moreModalLabel'>
                <div class='modal-dialog' role='document'>
                    <div class='modal-content' style="color: black">
                        <div class='modal-header'>
                            More about <b>{{moreDevice.name}}</b>
                            <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>
                        </div>
                        <div class='modal-body'>
                            <div class="panel-group" id="accordion">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <button class="btn btn-block btn-info text-capitalize" data-parent="#accordion" data-toggle="collapse" data-target="#collapseLocalisation">
                                            Location
                                        </button>
                                    </div>
                                    <div class="panel-body collapse text-capitalize" id="collapseLocalisation">
                                        <div id="mapMoreModal" style="height:200px">
                                        </div>
                                    </div>
                                </div>
                                <div class="panel panel-primary" ng-repeat="probe in moreDevice.probes">
                                    <div class="panel-heading">
                                        <button class="btn btn-block btn-info text-capitalize" data-parent="#accordion" data-toggle="collapse" data-target="#collapse{{probe.name}}">
                                            {{probe.label}}
                                        </button>
                                    </div>
                                    <div class="panel-body collapse text-capitalize" id="collapse{{probe.name}}">
                                        <ul>
                                            <li>
                                                <b>Enabled :</b> {{probe.active}}
                                            </li>
                                            <li>
                                                <b>Last update:</b> {{getReadableTime(probe.lastUpdate)}}
                                            </li>
                                            <li ng-repeat="(dataName,dataValue) in probe.data">
                                                <b>{{dataName}} :</b> {{dataValue}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <button class="btn btn-block btn-info text-capitalize" data-parent="#accordion" data-toggle="collapse" data-target="#collapseAvailableActions">
                                            Available actions
                                        </button>
                                    </div>
                                    <div class="panel-body collapse text-capitalize" id="collapseAvailableActions">
                                        <ul>
                                            <li ng-repeat="action in moreDevice.actionsAvailable">
                                                <b>{{action.label}}:</b> {{action.description}} <b>| Enabled :</b> {{action.enabled}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class='modal-footer' id="addModalFooter">
                            <button type='button' class='btn btn-secondary' data-dismiss='modal'>Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Action modal -->
        <div class="text-left" style="color: black">
            <div class='modal fade' id='actionModal' tabindex='-1' role='dialog' aria-labelledby='actionModalLabel'>
                <div class='modal-dialog' role='document'>
                    <div class='modal-content'>
                        <div class='modal-header'>
                            <h5 class="modal-title">Send <b>{{actionToSend.label}}</b> action to your device</h5>
                        </div>
                        <div class='modal-body'>
                            <i>Please enter the parameters of your action</i>
                            <p id="actionSendingParams"></p>
                        </div>
                        <div class='modal-footer' id="actionModalFooter">
                            <button type="button" class="btn btn-success" data-dismiss="modal"
                                    ng-click="sendAction(actionToSend)" ng-disabled="sendActionForm.$invalid">Send action</button>
                            <button type='button' class='btn btn-secondary' data-dismiss='modal'>Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Action to all modal -->
        <div class="text-left" style="color: black">
            <div class='modal fade' id='actionToAllModal' tabindex='-1' role='dialog' aria-labelledby='actionToAllModalLabel'>
                <div class='modal-dialog' role='document'>
                    <div class='modal-content'>
                        <div class='modal-header'>
                            <h5 class="modal-title">Send <b>{{actionToSendToAll.label}}</b> action to every device</h5>
                        </div>
                        <div class='modal-body'>
                            <i>Please enter the parameters of your action</i>
                            <p id="actionSendingToAllParams"></p>
                        </div>
                        <div class='modal-footer' id="actionModalFooter">
                            <button type="button" class="btn btn-success" data-dismiss="modal"
                                    ng-click="sendActionToAll(actionToSendToAll)" ng-disabled="sendActionForm.$invalid">Send action</button>
                            <button type='button' class='btn btn-secondary' data-dismiss='modal'>Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Delete modal -->
        <div class="text-left" style="color: black">
            <div class='modal fade' id='deleteModal' tabindex='-1' role='dialog' aria-labelledby='deleteModalLabel'>
                <div class='modal-dialog' role='document'>
                    <div class='modal-content'>
                        <div class='modal-header'>
                            <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>
                            <h5 class='modal-title'>Confirm delete of <b>{{deleteDevice.name}}</b></h5>
                        </div>
                        <div class='modal-body'>
                            <p>Are you sure you want to delete this device ?</p>
                        </div>
                        <div class='modal-footer' id="deleteModalFooter">
                            <button type="button" class="btn btn-danger" data-dismiss="modal" ng-click="deleteByUuid(deleteDevice.uuid)">Delete device</button>
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Choose event modal -->
        <div class="text-left" style="color: black">
            <div class='modal fade' id='chooseEventModal' tabindex='-1' role='dialog' aria-labelledby='chooseEventModalLabel'>
                <div class='modal-dialog' role='document'>
                    <div class='modal-content'>
                        <div class='modal-header' id="chooseEventModalHeader">
                            Available events for {{chooseEventDevice.name}}
                            <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>
                        </div>
                        <div class='modal-body' id="chooseEventModalBody">
                            <div class="list-group">
                                <a class="list-group-item" ng-repeat="event in chooseEventList" ng-class="{'disabled': event.disabled, 'active': event.selected}"
                                   ng-click="changeSelectedEvent(chooseEventList.indexOf(event))"><b>{{event.label}}</b> | <i>{{event.description}}</i></a>
                            </div>
                        </div>
                        <div class='modal-footer' id="chooseEventModalFooter">
                            <button class="btn btn-success" data-dismiss="modal" ng-click="addEventToDevice(selectedEvent,chooseEventDevice.uuid)" ng-disabled="!eventSelected">Add event to device</button>
                            <button class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- /.container -->
</section>

<!-- Event Skeleton -->
<section id="event" class="about bg-warning" ng-controller = 'EventSkeletonCtrl'>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
                <h2 class="fontAmethyst text-white">Event Skeletons</h2>
                <hr class="small">
            </div>
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
                <div class="btn-group" role="group" aria-label="...">
                    <button type="button" class="btn btn-primary" ng-click="updateListEventSkeleton()" ng-init="updateListEventSkeleton()"><i class="fa fa-refresh"></i> Update List</button>
                    <button type="button" class="btn btn-dark" ng-click="open('lg')"><i class="fa fa-plus"></i> Add</button>
                </div>
                <hr class="small">
            </div>
        </div>
        <div class="row gutter-10" >
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 gutter-10">
                <div class="alertPlaceEventSkeleton"></div>
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div ng-repeat="eventSkeleton in eventSkeletons">
                            <div class="panel panel-primary">
                                <div class="panel-heading">
                                    <div class="row gutter-10">
                                        <div class="col-lg-8 col-md-8 col-sm-8 col-xs-12 gutter-10">
                                            <h3 class="fontCounter" style="color: #FFCE54;">{{eventSkeleton.label}}</h3>
                                        </div>
                                        <div class="col-lg-4 col-md-4 col-sm-4 gutter-10 hidden-xs">
                                            <div class="btn-group pull-right" role="group" aria-label="...">
                                                <a role="button" class="btn btn-dark" data-toggle="collapse" data-target="#{{eventSkeleton.id}}"><i class="fa fa-info"></i></a>
                                                <a role="button" class="btn btn-warning" ng-click="deleteEventSkeleton(eventSkeleton)"><i class="fa fa-times"></i></a>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 gutter-10 visible-xs-block">
                                            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                                                <a role="button" class="btn btn-dark" data-toggle="collapse" data-target="#{{eventSkeleton.id}}"><i class="fa fa-info"></i></a>
                                                <a role="button" class="btn btn-warning" ng-click="deleteEventSkeleton(eventSkeleton)"><i class="fa fa-times"></i></a>
                                            </div>
                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                                <div class="panel-body collapse" id="{{eventSkeleton.id}}" >
                                    <div class="row gutter-10">
                                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 gutter-10">
                                            <p class="list-group-item-text">{{eventSkeleton.description}}</p>
                                            <hr class="reduce">
                                        </div>
                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 gutter-10">
                                            <h3 class="list-group-item-text text-aqua fontCounter">IF</h3>
                                            <div ng-repeat="ifCondition in eventSkeleton.if | notlocalisation">
                                                <h4><span class="label label-default">{{ifCondition.logicOperator}}</span></h4>
                                                <h4>
                                                    <span class="label label-primary"><i class="fa" ng-class="getTypeProbe(ifCondition.probe)"></i> {{getLabelProbe(ifCondition.probe)}}</span>
                                                    <span class="label label-warning">{{ifCondition.comparator}}</span>
                                                    <span class="label label-primary">{{ifCondition.value}}</span>
                                                </h4>
                                            </div>
                                            <div ng-repeat="ifCondition in eventSkeleton.if | localisation">
                                                <h4><span class="label label-default">{{ifCondition.logicOperator}}</span></h4>
                                                <h4>
                                                    <span class="label label-primary"><i class="fa fa-globe"></i> Localisation</span>
                                                    <span class="label label-warning">{{ifCondition.comparator == ">" ? "Inside" : "Outside"}}</span>
                                                    <a role="button" class="btn btn-dark btn-xs" ng-click=giveMap(eventSkeleton)>Load Map</a>
                                                    <div id="map{{eventSkeleton.id}}" style="width : 100%; height:200px"></div>
                                                </h4>
                                            </div>
                                            <hr class="reduce">
                                        </div>
                                        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 gutter-10">
                                            <h4 class="list-group-item-text text-grapefruit fontCounter">THEN</h4>
                                            <div ng-repeat="thenAction in eventSkeleton.action">
                                                <h4>
                                                    <span class="label label-danger"><i class="fa" ng-class="getTypeAction(thenAction.type)"></i> {{getLabelAction(thenAction.type)}}</span>
                                                    <span class="label label-primary">{{findParameter(thenAction.parameter, thenAction.type)}}</span>
                                                </h4>
                                                <p>{{giveMessage(thenAction.parameter, thenAction.type)}}</p>
                                            </div>
                                            <hr class="reduce">
                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Add modal -->
<section>
    <div class='modal fade' id='addModal' tabindex='-1' role='dialog' aria-labelledby='addModalLabel'>
        <div class='modal-dialog' role='document'>
            <div class='modal-content'>
                <div class='modal-header'>
                    <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>
                    <h5 class='modal-title'>Download application</h5>
                </div>
                <div class='modal-body'>
                    <div class="row">
                        <div class="col-md-6">
                            <div id="code"></div>
                            <script type="text/javascript">
                                new QRCode(document.getElementById("code"), "http://www.servu.ml");
                            </script>
                        </div>
                        <div class="col-md-6">
                            <p>Flash this code with your device to download the app for ANDROID</p>
                            <p class="text-muted"><i>Sorry iOS users, the app is not available for iOS devices yet</i></p>
                        </div>
                    </div>
                </div>
                <div class='modal-footer' id="addModalFooter">
                    <div class="row">
                        <div class="col-md-3 pull-left">
                            <img src="../img/soon-play.PNG" class="store">
                        </div>
                        <div class="col-md-3 pull-left">
                            <img src="../img/soon-app.PNG" class="store">
                        </div>
                    </div>
                    <button type='button' class='btn btn-secondary' data-dismiss='modal'>Cancel</button>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Action modal -->
<section>
    <div class='modal fade' id='actionModal' tabindex='-1' role='dialog' aria-labelledby='actionModalLabel'>
        <div class='modal-dialog' role='document'>
            <div class='modal-content'>
                <div class='modal-header'>
                    <h5 class="modal-title">Action sending confirmation</h5>
                    <button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>
                </div>
                <div class='modal-body' id="actionModalBody">

                </div>
                <div class='modal-footer' id="actionModalFooter">

                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-10 col-lg-offset-1 text-center">
                <h3 class="fontAmethyst"><strong>Serv U</strong></h3>
                <hr class="small">
                <p>1 Dr Albert Schweitzer Av.
                    <br>Talence, France 33400</p>
                <ul class="list-unstyled">
                    <li><i class="fa fa-phone fa-fw"></i> (123) 456-7890</li>
                    <li><i class="fa fa-envelope-o fa-fw"></i> <a href="mailto:ServU@gmail.com">ServU@gmail.com</a></li>
                </ul>
                <br>
                <ul class="list-inline">
                    <li>
                        <a href="https://www.facebook.com/"><i class="fa fa-facebook fa-fw fa-3x"></i></a>
                    </li>
                    <li>
                        <a href="https://twitter.com/"><i class="fa fa-twitter fa-fw fa-3x"></i></a>
                    </li>
                </ul>
                <hr class="small">
                <p class="text-muted">Copyright &copy; ServU Team 8 2017</p>
            </div>
        </div>
    </div>
    <a id="to-top" href="#top" class="btn btn-dark btn-lg"><i class="fa fa-chevron-up fa-fw fa-1x"></i></a>
</footer>
<!-- JAJAJ-->


<!-- jQuery -->
<script src="../js/jquery.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.9/validator.js"></script>

<!-- Bootstrap Core JavaScript -->

<script src="https://maps.google.com/maps/api/js?key=AIzaSyCDnP1bkcDq7KKvVBZfss5B1EfM99T7Bvc"></script>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>

<script src="../js/persoJS/controller.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/persoJS/devicesController.js"></script>
<script src="../js/persoJS/templates.js"></script>
<script src="../js/bootstrap-notify.js"></script>

<script src="../js/persoJS/controllers.js"></script>

<script src="../js/persoJS/controllerEventSkeleton.js"></script>
<script src="../js/persoJS/services.js"></script>

<!-- Validation JQuery Form -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.9/validator.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/1000hz-bootstrap-validator/0.11.9/validator.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<!--<script src="../js/bootstrap.min.js"></script>-->

<!-- Theme Bootstrap -->
<script type="text/javascript" src="../js/persoJS/themeBootstrap.js" ></script>

<!-- Personnal Script PITI -->
<script type="text/javascript" src="../js/persoJS/controlConnection.js" ></script>
<script src="../js/persoJS/ui-bootstrap-tpls-2.5.0.min.js"></script>


<script>var username = '<%= username %>'</script>
<script>
    document.title = 'Profile - <%= username%>';
    setCookie('token','<%= token%>',7);
    setCookie('username','<%= username%>',7);
    function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays*24*60*60*1000));
        var expires = "expires="+ d.toUTCString();
        document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
    }
    window.setTimeout(function() {
        $(".alert").fadeTo(500, 0).slideUp(500, function(){
            $(this).remove();
        });
    }, 4000);
</script>

</body>

</html>
